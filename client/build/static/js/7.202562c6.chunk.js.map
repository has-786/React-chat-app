{"version":3,"sources":["components/empty.js","components/header2.js","../node_modules/@material-ui/icons/ArrowBack.js","../node_modules/@material-ui/icons/Send.js","../node_modules/@material-ui/icons/CloudDownload.js","crypto/decrypt.js","crypto/encrypt.js","components/chatting.js"],"names":["useStyles","makeStyles","theme","empty","padding","marginLeft","marginRight","color","Empty","classes","_jsx","className","children","root","flexGrow","marginTop","arrowBtn","title","fontSize","Header2","props","token","localStorage","getItem","AppBar","position","_jsxs","Toolbar","IconButton","edge","ArrowBackIcon","onClick","history","goBack","dp","Avatar","src","url","concat","style","backgroundColor","width","height","Typography","variant","name","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","decoder","TextDecoder","encoder","TextEncoder","decryptFun","encrypted","salt","iv","buffer","console","log","Uint8Array","from","atob","c","charCodeAt","key","async","password","iterations","length","hash","algorithm","arguments","undefined","keyMaterial","window","crypto","subtle","importKey","encode","deriveKey","PBKDF2","decrypted","decrypt","slice","salt_len","decode","encryptFun","text","encrypt","concatennated","btoa","String","fromCharCode","toast","configure","minWidth","bullet","display","margin","transform","heading","textAlign","footer","float","paging","marginBottom","cursor","messageBox","flexWrap","borderRadius","bottom","main","border","paddingTop","container","minHeight","background","flexFlow","alignItems","justifyContent","msgs","maxWidth","paddingBottom","sendbox","download","section","left","top","zIndex","rightStyle","Chatting","_chat$room","matches","useMediaQuery","chat","useSelector","state","chatReducer","dispatch","useDispatch","link","room","emails","match","params","roomName","audio","Audio","openFile","setOpenFile","useState","handleCloseFile","document","getElementById","setPreviewD","setPreviewI","setPreviewV","message","setMessage","previewD","previewI","previewV","page","setPage","olderMsgs","setOlderMsgs","useRef","socket","io","transports","secureAxios","axios","create","baseURL","headers","Authorization","email","userReducer","socketConnections","emit","on","data","type","payload","msg","setTimeout","scrollTo","scrollHeight","behaviour","current","focus","path","split","then","_document$getElementB","play","getMessages","post","response","body","status","setData","get","catch","err","error","i","map","s","parseInt","end","useEffect","querySelector","disconnect","getCurrentTime","h","Date","getHours","m","getMinutes","sendMessage","time","getRandomValues","flag","join","a","href","click","class","Dialog","open","onClose","alt","controls","Button","fullWidth","file","files","includes","FormData","append","autoClose","bind","CircularProgress","id","Paper","elevation","includeStyle","_Fragment","CloudDownloadIcon","TextField","ref","placeholder","onKeyDown","evt","onChange","target","autoFocus","SendIcon","for","AttachFileIcon","URL","createObjectURL"],"mappings":"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","file":"static/js/7.202562c6.chunk.js","sourcesContent":["import React from \"react\"\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    empty: {\r\n        padding: '10px 10px 40px 10px',\r\n        marginLeft: '30%',\r\n        marginRight: '30%',\r\n        color: '#848884'\r\n      }\r\n}))\r\n\r\nconst Empty = () => {\r\n    const classes = useStyles()\r\n    return <div className={classes.empty}>Nothing here yet!</div>\r\n}\r\n\r\nexport default Empty","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport url from \"../url\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n    marginTop: '-50px'\r\n  },\r\n  arrowBtn: {\r\n    marginRight: '10px'\r\n  },\r\n  title: {\r\n    color: '#F5F5DC\t',\r\n    fontSize: '16px'\r\n  }\r\n}));\r\n\r\nexport default function Header2(props) {\r\n  const classes = useStyles();\r\n  const token = localStorage.getItem(\"token\");\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <IconButton\r\n            edge=\"start\"\r\n            className={classes.arrowBtn}\r\n            color=\"inherit\"\r\n            aria-label=\"menu\"\r\n          >\r\n            <ArrowBackIcon onClick={() => props.history.goBack()} />\r\n          </IconButton>\r\n          {props.dp\r\n            ? <IconButton\r\n                edge=\"start\"\r\n                color=\"inherit\"\r\n                aria-label=\"menu\"\r\n              >\r\n                <Avatar\r\n                  src={url + `/uploads/${props.dp}/${token}`}\r\n                  style={{ backgroundColor: \"lightgrey\", width: '40px', height: '40px' }}\r\n                />\r\n              </IconButton>\r\n            : null}\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            {props.name}\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n}\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"\n}), 'ArrowBack');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"\n}), 'Send');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z\"\n}), 'CloudDownload');\n\nexports.default = _default;","const decoder = new TextDecoder();\r\nconst encoder = new TextEncoder();\r\n\r\nconst fromBase64 = (buffer) =>\r\n  Uint8Array.from(atob(buffer), (c) => c.charCodeAt(0));\r\n\r\nconst PBKDF2 = async (\r\n  password,\r\n  salt,\r\n  iterations,\r\n  length,\r\n  hash,\r\n  algorithm = \"AES-CBC\"\r\n) => {\r\n  const keyMaterial = await window.crypto.subtle.importKey(\r\n    \"raw\",\r\n    encoder.encode(password),\r\n    { name: \"PBKDF2\" },\r\n    false,\r\n    [\"deriveKey\"]\r\n  );\r\n  return await window.crypto.subtle.deriveKey(\r\n    {\r\n      name: \"PBKDF2\",\r\n      salt: encoder.encode(salt),\r\n      iterations,\r\n      hash\r\n    },\r\n    keyMaterial,\r\n    { name: algorithm, length },\r\n    false, // we don't need to export our key!!!\r\n    [\"encrypt\", \"decrypt\"]\r\n  );\r\n};\r\n\r\nconst decryptFun = (encrypted, salt, iv) => {\r\n  //encrypted = fromBase64('g9cGh/FKtMV1LhnGvii6lBovkZihMw8CqHgwR7h64z25GXqNhzAdrOtUj6iaPXxQTP9pax1soyzwbFAoCQP1CQ==');\r\n  console.log(encrypted);\r\n  encrypted = fromBase64(encrypted);\r\n  console.log(encrypted);\r\n  const salt_len = 16;\r\n  const iv_len = 16;\r\n  console.log(iv);\r\n  console.log(salt);\r\n\r\n  return (async () => {\r\n    const key = await PBKDF2(\"my password\", salt, 100000, 256, \"SHA-256\");\r\n    const decrypted = await window.crypto.subtle.decrypt(\r\n      { name: \"AES-CBC\", iv },\r\n      key,\r\n      encrypted.slice(salt_len + iv_len)\r\n    );\r\n    console.log(decrypted);\r\n    return decoder.decode(decrypted);\r\n  })();\r\n};\r\n//console.log(decoder.decode(decrypted));\r\n\r\nexport default decryptFun;\r\n","const encoder = new TextEncoder();\r\nlet keyMaterial;\r\n\r\nconst toBase64 = (buffer) =>\r\n  btoa(String.fromCharCode(...new Uint8Array(buffer)));\r\n\r\nconst PBKDF2 = async (\r\n  password,\r\n  salt,\r\n  iterations,\r\n  length,\r\n  hash,\r\n  algorithm = \"AES-CBC\"\r\n) => {\r\n  keyMaterial = await window.crypto.subtle.importKey(\r\n    \"raw\",\r\n    encoder.encode(password),\r\n    { name: \"PBKDF2\" },\r\n    false,\r\n    [\"deriveKey\"]\r\n  );\r\n\r\n  return await window.crypto.subtle.deriveKey(\r\n    {\r\n      name: \"PBKDF2\",\r\n      salt: encoder.encode(salt),\r\n      iterations,\r\n      hash\r\n    },\r\n    keyMaterial,\r\n    { name: algorithm, length },\r\n    false, // we don't need to export our key!!!\r\n    [\"encrypt\", \"decrypt\"]\r\n  );\r\n};\r\n\r\nconst encryptFun = (text, salt, iv) => {\r\n  console.log(\"salt \" + salt + \" iv \" + iv);\r\n  console.log(text);\r\n  text = encoder.encode(text);\r\n\r\n  console.log(text);\r\n  return (async () => {\r\n    const key = await PBKDF2(\"my password\", salt, 100000, 256, \"SHA-256\");\r\n    let encrypted = await window.crypto.subtle.encrypt(\r\n      { name: \"AES-CBC\", iv },\r\n      key,\r\n      text\r\n    );\r\n    console.log(`Encrypted ${encrypted}`);\r\n\r\n    const concatennated = toBase64([\r\n      ...salt,\r\n      ...iv,\r\n      ...new Uint8Array(encrypted)\r\n    ]);\r\n    console.log(`concatennated ${concatennated}`);\r\n    return concatennated;\r\n  })();\r\n};\r\n\r\nexport default encryptFun;\r\n","import { React, useRef, useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport useMediaQuery from \"@material-ui/core/useMediaQuery\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport CloudDownloadIcon from \"@material-ui/icons/CloudDownload\";\r\nimport SendIcon from \"@material-ui/icons/Send\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\n\r\nimport axios from \"axios\";\r\nimport url from \"../url\";\r\nimport \"../css/chat.css\";\r\nimport Header2 from \"./header2\";\r\nimport io from \"socket.io-client\";\r\nimport decryptFun from \"../crypto/decrypt\";\r\nimport encryptFun from \"../crypto/encrypt\";\r\n\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Empty from \"./empty\";\r\ntoast.configure();\r\n\r\nlet socket;\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    minWidth: 275\r\n  },\r\n  bullet: {\r\n    display: \"inline-block\",\r\n    margin: \"0 2px\",\r\n    transform: \"scale(0.8)\"\r\n  },\r\n  title: {\r\n    fontSize: 14\r\n  },\r\n  heading: {\r\n    textAlign: \"justifyContent\"\r\n  },\r\n  footer: {\r\n    float: \"right\"\r\n  },\r\n  paging: {\r\n    margin: \"auto\",\r\n    backgroundColor: \"beige\",\r\n    color: \"#005\",\r\n    padding: \"3px\",\r\n    width: \"140px\",\r\n    marginBottom: \"20px\",\r\n    fontSize: \"13px\",\r\n    textAlign: \"center\",\r\n    cursor: \"pointer\"\r\n  },\r\n  messageBox: {\r\n    width: \"100%\",\r\n    flexWrap: \"wrap\",\r\n    borderRadius: \"10px\",\r\n    bottom: 0\r\n  },\r\n  main: {\r\n    border: \"1px solid black\",\r\n    paddingTop: \"70px\",\r\n    marginLeft: \"100px\",\r\n    width: \"100%\"\r\n  },\r\n  container: {\r\n    margin: \"auto\",\r\n    minHeight: \"70vh\",\r\n    padding: \"3px 4px\",\r\n    borderRadius: \"10px\",\r\n    background: \"linear-gradient(to right, #d62976, #fa7e1e)\",\r\n    display: \"flex\",\r\n    flexFlow: \"row wrap\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  msgs: {\r\n    width: \"250px\",\r\n    maxWidth: \"80%\",\r\n    marginBottom: \"10px\",\r\n    paddingBottom: \"12px\"\r\n  },\r\n  sendbox: {\r\n    width: \"100%\"\r\n  },\r\n  download: {\r\n    marginRight: \"-15px\",\r\n    color: \"white\"\r\n  },\r\n  section: {\r\n  background: \"linear-gradient(to right, #4682B4, #87CEEB)\"\r\n  },\r\n  empty: {\r\n    position: 'fixed',\r\n    width: '100%',\r\n    left: '22%',\r\n    top: '42vh',\r\n    zIndex: '1'\r\n  }\r\n});\r\n\r\nconst rightStyle = {\r\n  marginLeft: \"auto\",\r\n  backgroundColor: \"#fffcb7\",\r\n  color: \"black\"\r\n};\r\n\r\nconst Chatting = (props) => {\r\n  const classes = useStyles();\r\n  const matches = useMediaQuery(\"(min-width:600px)\");\r\n  const chat = useSelector((state) => state.chatReducer);\r\n  const dispatch = useDispatch();\r\n  let link;\r\n  let { room, emails } = props.match.params;\r\n  const { roomName, dp } = props;\r\n\r\n  if (room !== roomName) link = `/personal/${room}/${emails}`;\r\n  else link = `/chat/${room}`;\r\n\r\n  let audio;\r\n  if (room === roomName) audio = new Audio(\"../incoming.mp3\");\r\n  else audio = new Audio(\"../../incoming.mp3\");\r\n\r\n  const [openFile, setOpenFile] = useState(false);\r\n\r\n  const handleCloseFile = () => {\r\n    document.getElementById(\"file-input\").value = \"\";\r\n    setPreviewD(\"\");\r\n    setPreviewI(\"\");\r\n    setPreviewV(\"\");\r\n    setOpenFile(false);\r\n  };\r\n  const handleOpenFile = () => setOpenFile(true);\r\n\r\n  const [message, setMessage] = useState(\"\");\r\n  const [previewD, setPreviewD] = useState(\"\");\r\n  const [previewI, setPreviewI] = useState(\"\");\r\n  const [previewV, setPreviewV] = useState(\"\");\r\n  const [page, setPage] = useState(2);\r\n  const [olderMsgs, setOlderMsgs] = useState(\"block\");\r\n  const sendbox = useRef(null);\r\n  const socket = io(url, { transports: [\"websocket\", \"polling\"] });\r\n\r\n  const token = localStorage.getItem(\"token\");\r\n\r\n  const secureAxios = axios.create({\r\n    baseURL: url,\r\n    headers: {\r\n      Authorization: `bearer ${token}`\r\n    }\r\n  });\r\n\r\n  const email = useSelector((state) => state.userReducer.email);\r\n  const name = useSelector((state) => state.userReducer.name);\r\n\r\n  const socketConnections = (socket, name, email) => {\r\n    socket.emit(\"create\", room);\r\n    socket.emit(\"user-joined\", name, room);\r\n    socket.on(\"receiveimg\", (data) => {\r\n      if (email === data.email) {\r\n        document.getElementById(\"loader\").style.display = \"none\"(async () => {\r\n          dispatch({ type: \"add_chat\", payload: { room, msg: data } });\r\n          setTimeout(\r\n            () =>\r\n              window.scrollTo({\r\n                top: document.getElementById(\"messages\").scrollHeight,\r\n                behaviour: \"smooth\"\r\n              }),\r\n            500\r\n          );\r\n          sendbox.current.focus();\r\n        })();\r\n      }\r\n    });\r\n\r\n    socket.on(\"receive\", (data) => {\r\n      console.log(\"receive data\", data);\r\n      if (email === data.email) return;\r\n      dispatch({ type: \"add_recent\", payload: { room, roomName, link, dp } });\r\n      (async () => {\r\n          if (!data.path) {\r\n            data.salt = data.salt.split(\",\");\r\n            data.iv = data.iv.split(\",\");\r\n\r\n            data.salt = new Uint8Array(data.salt);\r\n            data.iv = new Uint8Array(data.iv);\r\n\r\n            await decryptFun(data.message, data.salt, data.iv).then(\r\n              (decrypted) => {\r\n                data.message = decrypted;\r\n              }\r\n            );\r\n          }\r\n\r\n          (async () => {\r\n            dispatch({ type: \"add_chat\", payload: { room, msg: data } });\r\n\r\n            if (!data.path)\r\n              window.scrollTo({\r\n                top: document.getElementById(\"messages\")?.scrollHeight,\r\n                behaviour: \"smooth\"\r\n              });\r\n            else\r\n              setTimeout(\r\n                () =>\r\n                  window.scrollTo({\r\n                    top: document.getElementById(\"messages\").scrollHeight,\r\n                    behaviour: \"smooth\"\r\n                  }),\r\n                500\r\n              );\r\n\r\n            sendbox.current.focus();\r\n          })();\r\n\r\n          audio.play();\r\n        }\r\n      )();\r\n    });\r\n  };\r\n\r\n  async function getMessages(page) {\r\n    await secureAxios\r\n      .post(\"getMessages\", { room, page })\r\n      .then((response) => {\r\n        const body = response.data;\r\n        if (body.status == 1) {\r\n          if (!body.end) setOlderMsgs(\"block\");\r\n          else setOlderMsgs(\"none\");\r\n\r\n          async function setData() {\r\n            if (page === 1) {\r\n              await secureAxios\r\n                .get(\"getUser\")\r\n                .then((response) => {\r\n                  const body = response.data;\r\n                  dispatch({ type: \"load_user\", payload: body });\r\n                  socketConnections(socket, body.name, body.email);\r\n                })\r\n                .catch((err) => toast.error(err));\r\n            }\r\n\r\n            await (async function () {\r\n              const msgs = body.msgs;\r\n              for (let i = 0; i < msgs.length; i++) {\r\n                const data = msgs[i];\r\n\r\n                if (!data.path) {\r\n                  data.salt = data.salt.split(\",\");\r\n                  data.iv = data.iv.split(\",\");\r\n\r\n                  data.salt = data.salt.map((s) => parseInt(s));\r\n                  data.iv = data.iv.map((iv) => parseInt(iv));\r\n\r\n                  data.salt = new Uint8Array(data.salt); // salt and\r\n                  data.iv = new Uint8Array(data.iv); //iv for decrypting the message\r\n\r\n                  await decryptFun(data.message, data.salt, data.iv).then(\r\n                    (decrypted) => {\r\n                      data.message = decrypted; // decrypt the received message\r\n                    }\r\n                  );\r\n                }\r\n              }\r\n              dispatch({ type: \"load_chat\", payload: { room, msgs } });\r\n            })();\r\n\r\n            if (page === 1) {\r\n              setTimeout(\r\n                () =>\r\n                  window.scrollTo({\r\n                    top: document.getElementById(\"messages\").scrollHeight,\r\n                    behaviour: \"smooth\"\r\n                  }),\r\n                350\r\n              );\r\n            }\r\n            setPage((page) => page + 1);\r\n          }\r\n\r\n          setData();\r\n        }\r\n      })\r\n      .catch((err) => {});\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (chat[room]) socketConnections(socket, name, email);\r\n    else getMessages(1);\r\n\r\n    return () => {\r\n      document.querySelector(\"body\").style.backgroundColor = \"\";\r\n      socket.disconnect();\r\n      dispatch({ type: \"delete_chat\", payload: room });\r\n    };\r\n  }, []);\r\n\r\n  const getCurrentTime = () => {\r\n    let h = new Date().getHours();\r\n    let m = new Date().getMinutes();\r\n    h = parseInt(h / 10) === 0 ? \"0\" + h : h;\r\n    m = parseInt(m / 10) === 0 ? \"0\" + m : m;\r\n    return h + \":\" + m;\r\n  };\r\n\r\n  const sendMessage = (name, room, msg) => {\r\n    if (msg === \"\") return;\r\n    const time = getCurrentTime();\r\n    let text = msg;\r\n    document.getElementById(\"loader\").style.display = \"block\";\r\n\r\n    console.log('window.crypto.getRandomValues', window.crypto.getRandomValues)\r\n    let salt = window.crypto.getRandomValues(new Uint8Array(16)),\r\n    iv = window.crypto.getRandomValues(new Uint8Array(16));\r\n\r\n    (async () => {\r\n      dispatch({\r\n        type: \"add_chat\",\r\n        payload: {\r\n          room,\r\n          msg: { flag: 0, email, room, name, message: msg, time }\r\n        }\r\n      });\r\n      dispatch({ type: \"add_recent\", payload: { room, roomName, link, dp } });\r\n\r\n      window.scrollTo({\r\n        top: document.getElementById(\"messages\").scrollHeight,\r\n        behaviour: \"smooth\"\r\n      });\r\n\r\n      sendbox.current.focus();\r\n    })();\r\n\r\n    encryptFun(text, salt, iv).then((encrypted) => {\r\n      console.log(encrypted);\r\n      salt = [...salt];\r\n      iv = [...iv];\r\n      salt = salt.join(\",\");\r\n      iv = iv.join(\",\");\r\n\r\n      socket.emit(\"send\", {\r\n        flag: 0,\r\n        email,\r\n        room,\r\n        name,\r\n        msg: encrypted,\r\n        path: null,\r\n        salt,\r\n        iv,\r\n        time,\r\n        roomName,\r\n        link,\r\n        dp\r\n      });\r\n      document.getElementById(\"loader\").style.display = \"none\";\r\n      setMessage(\"\");\r\n    });\r\n  };\r\n\r\n  async function sendFile() {\r\n    const file = document.getElementById(\"file-input\").files[0];\r\n\r\n    if (!document.getElementById(\"file-input\").value) return;\r\n    document.getElementById(\"file-input\").value = \"\";\r\n    document.getElementById(\"loader\").style.display = \"block\";\r\n\r\n    handleCloseFile();\r\n\r\n    const time = getCurrentTime();\r\n\r\n    let flag = 4;\r\n    if (file.type.includes(\"image\")) flag = 1;\r\n    else if (file.type.includes(\"video\")) flag = 2;\r\n    else if (file.type.includes(\"audio\")) flag = 3;\r\n\r\n    let data = new FormData();\r\n    data.append(\"file\", file);\r\n\r\n    secureAxios\r\n      .post(\"sendFile\", data)\r\n      .then((response) => {\r\n        const body = response.data;\r\n\r\n        if (body.status === 1) {\r\n          if (file) file.value = \"\";\r\n          document.getElementById(\"loader\").style.display = \"none\";\r\n          dispatch({\r\n            type: \"add_chat\",\r\n            payload: {\r\n              room,\r\n              msg: {\r\n                flag,\r\n                email,\r\n                room,\r\n                name,\r\n                msg: null,\r\n                path: file.name,\r\n                time,\r\n                roomName,\r\n                link\r\n              }\r\n            }\r\n          });\r\n          dispatch({\r\n            type: \"add_recent\",\r\n            payload: { room, roomName, link, dp }\r\n          });\r\n\r\n          socket.emit(\"send\", {\r\n            flag,\r\n            email,\r\n            room,\r\n            name,\r\n            msg: null,\r\n            path: file.name,\r\n            time,\r\n            roomName,\r\n            link,\r\n            dp\r\n          });\r\n        } else toast.error(\"Something went wrong\", { autoClose: 1000 });\r\n      })\r\n      .catch((err) => toast.error(\"Something went wrong\", { autoClose: 1000 }));\r\n  }\r\n\r\n  const download = (path) => {\r\n    const a = document.createElement(\"a\");\r\n    a.href = path;\r\n    a.click();\r\n  };\r\n\r\n  return (\r\n    <div class={classes.section}>\r\n      <center>\r\n        <Dialog\r\n          open={openFile}\r\n          onClose={handleCloseFile}\r\n          aria-labelledby=\"alert-dialog-title\"\r\n          aria-describedby=\"alert-dialog-description\"\r\n        >\r\n          <center>\r\n            <img\r\n              src={previewI}\r\n              style={{ display: previewI ? \"block\" : \"none\" }}\r\n              width=\"100%\"\r\n              height=\"100%\"\r\n              alt=\"\"\r\n            />\r\n            <video\r\n              style={{ display: previewV ? \"block\" : \"none\" }}\r\n              width=\"100%\"\r\n              height=\"100%\"\r\n              controls\r\n            >\r\n              <source src={previewV} type=\"video/mp4\" />\r\n              <source src={previewV} type=\"video/ogg\" />\r\n            </video>\r\n\r\n            <div\r\n              style={{\r\n                display: previewD != \"\" ? \"block\" : \"none\",\r\n                padding: \"50px\"\r\n              }}\r\n            >\r\n              {previewD}\r\n            </div>\r\n          </center>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={sendFile.bind(this)}\r\n          >\r\n            Send\r\n          </Button>\r\n        </Dialog>\r\n      </center>\r\n\r\n      <div\r\n        style={{\r\n          position: \"fixed\",\r\n          width: \"90%\",\r\n          zIndex: 10,\r\n          marginLeft: \"240px\",\r\n          marginTop: \"45px\"\r\n        }}\r\n      >\r\n        <Header2 name={roomName} dp={dp} {...props} />\r\n        <center>\r\n          <CircularProgress\r\n            id=\"loader\"\r\n            style={{ marginTop: \"100px\", display: \"none\" }}\r\n          />\r\n        </center>\r\n      </div>\r\n\r\n      <div class={classes.main}>\r\n        <div\r\n          class={classes.container}\r\n          id=\"container\"\r\n          style={{ width: matches ? \"50%\" : \"100%\" }}\r\n        >\r\n          <div id=\"messages\" class={classes.messageBox}>\r\n            {!!chat[room] && (\r\n              <Paper\r\n                elevation={3}\r\n                className={classes.paging}\r\n                style={{ display: olderMsgs }}\r\n                onClick={getMessages.bind(this, page)}\r\n              >\r\n                See Older Messages\r\n              </Paper>\r\n            )}\r\n            {!!chat[room]?.length ? chat[room].map((msg) => {\r\n                let includeStyle = email === msg.email ? rightStyle : {};\r\n\r\n                return (\r\n                  <Paper\r\n                    elevation={3}\r\n                    className={classes.msgs}\r\n                    style={{ ...includeStyle }}\r\n                  >\r\n                    {msg.flag === 0 ? (\r\n                      <div style={{ padding: \"10px\" }}>\r\n                        {room === roomName ? (\r\n                          <>\r\n                            <b>{msg.name}</b>\r\n                            <br />\r\n                          </>\r\n                        ) : null}\r\n                        <span>{msg.message}</span>\r\n                        <br />\r\n                        <span style={{ float: \"right\" }}>{msg.time}</span>\r\n                      </div>\r\n                    ) : msg.flag === 1 ? (\r\n                      <div style={{ padding: \"10px\" }}>\r\n                        {room === roomName ? (\r\n                          <>\r\n                            <b>{msg.name}</b>\r\n                            <br />\r\n                          </>\r\n                        ) : null}\r\n                        <span>\r\n                          <img\r\n                            src={`${url}/uploads/${msg.path}/${token}`}\r\n                            height=\"100%\"\r\n                            width=\"100%\"\r\n                            alt=\"\"\r\n                          />\r\n                        </span>\r\n                        <span>\r\n                          {msg.path}{\" \"}\r\n                          <CloudDownloadIcon\r\n                            color=\"primary\"\r\n                            style={{ float: \"right\" }}\r\n                            onClick={download.bind(\r\n                              this,\r\n                              url + `/uploads/${msg.path}/${token}`\r\n                            )}\r\n                          />\r\n                        </span>\r\n                        <br />\r\n                        <br />\r\n                        <span style={{ float: \"right\", paddingBottom: \"50px\" }}>\r\n                          {msg.time}\r\n                        </span>\r\n                      </div>\r\n                    ) : msg.flag === 2 ? (\r\n                      <div style={{ padding: \"10px\" }}>\r\n                        {room === roomName ? (\r\n                          <>\r\n                            <b>{msg.name}</b>\r\n                            <br />\r\n                          </>\r\n                        ) : null}\r\n                        <video width=\"100%\" height=\"100%\" controls>\r\n                          <source\r\n                            src={url + `/uploads/${msg.path}/${token}`}\r\n                            type=\"video/mp4\"\r\n                          />\r\n                          <source\r\n                            src={url + `/uploads/${msg.path}/${token}`}\r\n                            type=\"video/wav\"\r\n                          />\r\n                          <source\r\n                            src={url + `/uploads/${msg.path}/${token}`}\r\n                            type=\"video/ogg\"\r\n                          />\r\n                        </video>\r\n                        <span>\r\n                          {msg.path}{\" \"}\r\n                          <CloudDownloadIcon\r\n                            color=\"primary\"\r\n                            style={{ float: \"right\" }}\r\n                            onClick={download.bind(\r\n                              this,\r\n                              url + `/uploads/${msg.path}/${token}`\r\n                            )}\r\n                          />\r\n                        </span>\r\n                        <br />\r\n                        <br />\r\n                        <span style={{ float: \"right\" }}>{msg.time}</span>\r\n                      </div>\r\n                    ) : msg.flag === 3 ? (\r\n                      <div style={{ padding: \"10px\" }}>\r\n                        {room === roomName ? (\r\n                          <>\r\n                            <b>{msg.name}</b>\r\n                            <br />\r\n                          </>\r\n                        ) : null}\r\n                        <audio controls>\r\n                          <source\r\n                            src={url + `/uploads/${msg.path}/${token}`}\r\n                            type=\"audio/ogg\"\r\n                          />\r\n                          <source\r\n                            src={url + `/uploads/${msg.path}/${token}`}\r\n                            type=\"audio/mpeg\"\r\n                          />\r\n                        </audio>\r\n                        <span>\r\n                          {msg.path}{\" \"}\r\n                          <CloudDownloadIcon\r\n                            color=\"primary\"\r\n                            style={{ float: \"right\" }}\r\n                            onClick={download.bind(\r\n                              this,\r\n                              url + `/uploads/${msg.path}/${token}`\r\n                            )}\r\n                          />\r\n                        </span>\r\n                        <br />\r\n                        <br />\r\n                        <span style={{ float: \"right\" }}>{msg.time}</span>\r\n                      </div>\r\n                    ) : (\r\n                      <div style={{ padding: \"10px\" }}>\r\n                        {room === roomName ? (\r\n                          <>\r\n                            <b>{msg.name}</b>\r\n                            <br />\r\n                          </>\r\n                        ) : null}\r\n                        <span>\r\n                          {\" \"}\r\n                          {msg.path}{\" \"}\r\n                          <CloudDownloadIcon\r\n                            color=\"primary\"\r\n                            style={{ float: \"right\" }}\r\n                            onClick={download.bind(\r\n                              this,\r\n                              url + `/uploads/${msg.path}/${token}`\r\n                            )}\r\n                          />\r\n                        </span>\r\n                        <br />\r\n                        <br />\r\n                        <span style={{ float: \"right\" }}>{msg.time}</span>\r\n                      </div>\r\n                    )}\r\n                  </Paper>\r\n                );\r\n              }) : <div className={classes.empty}><Empty /></div>}\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <center>\r\n            <div class={classes.sendbox} style={{ marginBottom: \"40px\" }}>\r\n              <TextField\r\n                type=\"text\"\r\n                ref={sendbox}\r\n                style={{ width: \"45%\" }}\r\n                placeholder=\"Type your message here\"\r\n                value={message}\r\n                onKeyDown={evt => { \r\n                  if(evt.key === 'Enter') {\r\n                    sendMessage(name, room, message)\r\n                  }\r\n                }}\r\n                onChange={(evt) => setMessage(evt.target.value)}\r\n                autoFocus\r\n              />\r\n              <SendIcon\r\n                color=\"primary\"\r\n                onClick={sendMessage.bind(this, name, room, message)}\r\n              />\r\n              <label for=\"file-input\">\r\n                <AttachFileIcon\r\n                  color=\"secondary\"\r\n                  style={{ marginLeft: \"5px\" }}\r\n                />\r\n              </label>\r\n              <input\r\n                id=\"file-input\"\r\n                type=\"file\"\r\n                style={{ display: \"none\" }}\r\n                onChange={(evt) => {\r\n                  handleOpenFile();\r\n                  evt.target.files[0].type.includes(\"image\")\r\n                    ? setPreviewI(\r\n                        window.URL.createObjectURL(evt.target.files[0])\r\n                      )\r\n                    : evt.target.files[0].type.includes(\"video\")\r\n                    ? setPreviewV(\r\n                        window.URL.createObjectURL(evt.target.files[0])\r\n                      )\r\n                    : setPreviewD(evt.target.files[0].name);\r\n                }}\r\n              />\r\n            </div>\r\n          </center>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chatting;\r\n"],"sourceRoot":""}