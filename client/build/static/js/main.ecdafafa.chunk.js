(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[1],{12:function(e,t,a){"use strict";t.a="http://localhost:50052"},170:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(11),c=a.n(r),o=a(63),s=a(13),i=a(9),l=a(52),d=a(93);const p=Object(l.b)({groupReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rooms:[],latest:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_group":return t.payload;case"add_my_group":return{...e,rooms:[...e.rooms,t.payload],latest:[...e.latest,t.payload]};case"add_latest_group":return e.latest.includes(t.payload)?e:{...e,latest:[...e.latest,t.payload]};case"exit_group":return{...e,latest:e.latest.filter((e=>e!=t.payload))};case"edit_group":return{...e,exist:!1};case"delete_my_group":return{...e,rooms:e.rooms.filter((e=>e!=t.payload)),latest:e.latest.filter((e=>e!=t.payload))};case"clear":return{rooms:[],latest:[],exist:!1};default:return e}},chatReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=JSON.parse(JSON.stringify(e));switch(t.type){case"load_chat":return a[t.payload.room]?a[t.payload.room]=[...t.payload.msgs,...a[t.payload.room]]:a[t.payload.room]=t.payload.msgs,a;case"add_chat":return a[t.payload.room]?a[t.payload.room]=[...a[t.payload.room],t.payload.msg]:a[t.payload.room]=[t.payload.msg],a;case"delete_chat":return delete a[t.payload],a;case"clear":return{};default:return e}},userReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,email:null,path:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_user":return t.payload;case"clear":return{name:null,email:null,path:null};default:return e}},friendReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pendings:[],friends:[],sent:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_friend":return t.payload;case"set_friend":const a=t.payload.profile,n=t.payload.option;return"Accept"==n?{...e,pendings:e.pendings.filter((e=>e.email!=a.email)),friends:e.friends.concat(a)}:"Disconnect"==n||"Cancel request"==n?{...e,sent:e.sent.filter((e=>e.email!=a.email)),pendings:e.pendings.filter((e=>e.email!=a.email)),friends:e.friends.filter((e=>e.email!=a.email))}:{...e,sent:e.sent.concat(a)};case"clear":return{pendings:[],friends:[],sent:[],exist:!1};default:return e}},profileReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_profile":return t.payload;case"clear":return{};default:return e}},startReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start":return{exist:t.payload};case"end":case"clear":return{exist:0};default:return e}},postReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:!1,post:[]},t=arguments.length>1?arguments[1]:void 0;const a=[...e.post];let n,r;switch(t.type){case"load_post":return{exist:!0,post:t.payload.reverse()};case"add_post":return{...e,post:[t.payload,...e.post]};case"like_post":for(let e=0;e<a.length;e++)a[e]._id===t.payload._id&&(t.payload.liked?(a[e].likeCount--,a[e].liked=!1):(a[e].likeCount++,a[e].liked=!0));return{...e,post:a};case"hide_post":return{...e,post:e.post.filter((e=>e._id!=t.payload))};case"add_comment":return n=a.find((e=>e._id===t.payload._id)).comment,n=[t.payload.comment,...n],a.find((e=>e._id===t.payload._id)).comment=n,{...e,post:a};case"add_reply":return r=a.find((e=>e._id===t.payload._id)).comment[t.payload.index].reply,r=[t.payload.comment,...r],a.find((e=>e._id===t.payload._id)).comment[t.payload.index].reply=r,{...e,post:a};case"edit_comment":return a.find((e=>e._id===t.payload._id)).comment[t.payload.index1]=t.payload.commentData,{...e,post:a};case"edit_reply":return a.find((e=>e._id===t.payload._id)).comment[t.payload.index].reply[t.payload.index1]=t.payload.commentData,{...e,post:a};case"delete_comment":return a.find((e=>e._id===t.payload._id)).comment.splice(t.payload.index1,1),{...e,post:a};case"delete_reply":return a.find((e=>e._id===t.payload._id)).comment[t.payload.index].reply.splice(t.payload.index1,1),{...e,post:a};case"clear":return{exist:!1,post:[]};default:return e}},recentReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0,chats:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_recent":return{exist:1,chats:t.payload};case"add_recent":return{exist:1,chats:[t.payload,...e.chats.filter((e=>e.roomName!==t.payload.roomName))]};case"clear":return{exist:0,chats:[]};default:return e}}});var u=p;var j=Object(l.c)(u,[],Object(l.a)(d.a)),b=a(75),h=a(14),m=a.n(h),O=a(12),g=a(172),x=a(179),f=a(2);const y=Object(g.a)((e=>({root:{marginTop:"50vh"}})));function v(){const e=y();return Object(f.jsx)("div",{className:e.root,children:Object(f.jsxs)("center",{children:[Object(f.jsx)(x.a,{}),Object(f.jsx)("div",{children:"Loading...Please wait"})]})})}function _(e,t){return function(a){const[r,c]=Object(n.useState)(0),o=Object(i.c)((e=>e.startReducer.exist)),s=Object(i.b)();return Object(n.useEffect)((()=>{if(o)c(1);else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((e=>{e.data;s({type:"start",exist:1}),c(1)})).catch((e=>{c(2)}))}}),[]),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{...a}):Object(f.jsx)(t,{redirect:"signin"})}}var w=a(174);const R=Object(n.lazy)((()=>a.e(18).then(a.bind(null,316)))),S=Object(n.lazy)((()=>Promise.all([a.e(0),a.e(6)]).then(a.bind(null,332)))),k=Object(n.lazy)((()=>a.e(9).then(a.bind(null,317)))),C=Object(n.lazy)((()=>Promise.all([a.e(0),a.e(7)]).then(a.bind(null,331)))),z=Object(n.lazy)((()=>a.e(12).then(a.bind(null,265)))),I=Object(n.lazy)((()=>Promise.all([a.e(0),a.e(5)]).then(a.bind(null,318)))),E=Object(n.lazy)((()=>a.e(10).then(a.bind(null,319)))),B=Object(n.lazy)((()=>a.e(11).then(a.bind(null,320)))),L=Object(n.lazy)((()=>a.e(13).then(a.bind(null,321)))),U=Object(n.lazy)((()=>a.e(15).then(a.bind(null,322)))),P=Object(n.lazy)((()=>a.e(8).then(a.bind(null,323)))),A=Object(n.lazy)((()=>Promise.all([a.e(4),a.e(17)]).then(a.bind(null,324)))),N=Object(n.lazy)((()=>Promise.all([a.e(14),a.e(16)]).then(a.bind(null,330))));var F,D;c.a.render(Object(f.jsx)(i.a,{store:j,children:Object(f.jsx)(n.Suspense,{fallback:Object(f.jsx)(v,{}),children:Object(f.jsxs)(o.a,{children:[Object(f.jsx)("div",{style:{position:"fixed",width:"100%",zIndex:10},children:Object(f.jsx)(b.a,{})}),Object(f.jsx)(w.a,{}),Object(f.jsxs)(s.d,{children:[Object(f.jsx)(s.b,{exact:!0,path:"/",component:(F=A,D=R,function(e){const[t,a]=Object(n.useState)(0),r=Object(i.c)((e=>e.userReducer.email)),c=Object(i.b)();return Object(n.useEffect)((()=>{if(r)a(1);else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getUser").then((e=>{const t=e.data;c({type:"start",payload:1}),c({type:"load_user",payload:{name:t.name,email:t.email,path:t.path}}),a(1)})).catch((e=>{a(2)}))}}),[]),0==t?Object(f.jsx)(v,{}):1==t?Object(f.jsx)(F,{...e}):Object(f.jsx)(D,{redirect:"signin"})})}),Object(f.jsx)(s.b,{path:"/chats",component:_(k,R)}),Object(f.jsx)(s.b,{path:"/groups",component:_(S,R)}),Object(f.jsx)(s.b,{path:"/enterroom",component:function(e,t){return function(a){const[r,c]=Object(n.useState)(0),o=Object(i.c)((e=>e.groupReducer.exist));return Object(n.useEffect)((()=>{if(o)c(1);else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((()=>{c(1)})).catch((e=>{c(2)}))}})),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{...a}):Object(f.jsx)(t,{redirect:"signin"})}}(U,R)}),Object(f.jsx)(s.b,{path:"/newroom",component:function(e,t){return function(a){const[r,c]=Object(n.useState)(0),o=Object(i.c)((e=>e.groupReducer.exist));return Object(n.useEffect)((()=>{if(o)c(1);else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((e=>{e.data;c(1)})).catch((e=>{c(2)}))}}),[]),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{...a}):Object(f.jsx)(t,{redirect:"signin"})}}(L,R)}),Object(f.jsx)(s.b,{path:"/profile/:profile",component:function(e,t){return function(a){const[r,c]=Object(n.useState)(0),[o,s]=Object(n.useState)("signin"),l=Object(i.b)(),[d,p]=(Object(i.c)((e=>e.groupReducer.exist)),a.match.params.profile.split("-"));return Object(n.useEffect)((()=>{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).post("getProfile",{email:d}).then((e=>{const t=e.data;1==t.status?(l({type:"load_profile",payload:{name:t.name,email:t.email,path:t.path}}),c(1)):(c(2),s(""))})).catch((e=>{c(2)}))}),[]),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{...a}):Object(f.jsx)(t,{redirect:o})}}(z,R)}),Object(f.jsx)(s.b,{path:"/friends",component:function(e,t){return function(a){const[r,c]=Object(n.useState)(0),o=Object(i.c)((e=>e.startReducer.exist)),s=Object(i.b)();return Object(n.useEffect)((()=>{if(o)c(1);else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((e=>{e.data;s({type:"start",payload:1}),c(1)})).catch((e=>{c(2)}))}}),[]),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{...a}):Object(f.jsx)(t,{redirect:"signin"})}}(I,R)}),Object(f.jsx)(s.b,{exact:!0,path:"/chat/:room",component:function(e,t){return function(a){const[r,c]=Object(n.useState)(0),[o,s]=Object(n.useState)("signin"),l=a.match.params.room,d=Object(i.c)((e=>e.groupReducer.exist)),p=Object(i.c)((e=>e.groupReducer.latest));return Object(n.useEffect)((()=>{if(d)p.includes(l)?c(1):(s("enterroom"),c(2));else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((e=>{e.data.latest.includes(l)?c(1):(s("enterroom"),c(2))})).catch((e=>{c(2)}))}}),[]),0==r?Object(f.jsx)(v,{}):1==r?Object(f.jsx)(e,{roomName:l,...a}):Object(f.jsx)(t,{redirect:o})}}(C,R)}),Object(f.jsx)(s.b,{exact:!0,path:"/personal/:room/:emails",component:function(e,t){let a="",r="";return function(c){const[o,s]=Object(n.useState)(0),[l,d]=Object(n.useState)("signin"),[p]=c.match.params.emails.split("-"),u=Object(i.b)(),j=Object(i.c)((e=>e.friendReducer.exist)),b=Object(i.c)((e=>e.friendReducer.friends));return Object(n.useEffect)((()=>{if(j){var e,t;a=null===(e=b.find((e=>e.email==p)))||void 0===e?void 0:e.name,r=null===(t=b.find((e=>e.email==p)))||void 0===t?void 0:t.path,a?s(1):(d(""),s(2))}else{const e=localStorage.getItem("token");m.a.create({baseURL:O.a,headers:{Authorization:"bearer ".concat(e)}}).get("getFriend").then((e=>{var t,n;const c=e.data;u({type:"load_friend",payload:{friends:c.friends,pendings:c.pendings,sent:c.sent,exist:!0}}),a=null===(t=c.friends.find((e=>e.email==p)))||void 0===t?void 0:t.name,r=null===(n=c.friends.find((e=>e.email==p)))||void 0===n?void 0:n.path,a?s(1):(d(""),s(2))})).catch((e=>{s(2)}))}}),[]),0==o?Object(f.jsx)(v,{}):1==o?Object(f.jsx)(e,{roomName:a,dp:r,...c}):Object(f.jsx)(t,{redirect:l})}}(C,R)}),Object(f.jsx)(s.b,{path:"/signin",component:E}),Object(f.jsx)(s.b,{path:"/signup",component:B}),Object(f.jsx)(s.b,{path:"/changePassword",component:P}),Object(f.jsx)(s.b,{path:"/uploadpost",component:N})]})]})})}),document.getElementById("root"))},75:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(13),o=a(9),s=a(98),i=a.n(s),l=a(78),d=a.n(l),p=a(114),u=a(115),j=a(117),b=a(172),h=a(174),m=a(107),O=a(108),g=a(109),x=a(178),f=a(175),y=a(113),v=a(71),_=a(177),w=a(100),R=a.n(w),S=a(103),k=a.n(S),C=a(99),z=a.n(C),I=a(90),E=a.n(I),B=a(101),L=a.n(B),U=a(74),P=a.n(U),A=a(76),N=a.n(A),F=a(102),D=a.n(F),T=a(110),G=a(176),J=a(119),M=a(179),W=a(49),q=a(180),H=a(106),K=a(14),Q=a.n(K),V=a(12),X=a(42),Y=(a(123),a(2));X.a.configure();const Z=240,$=Object(b.a)((e=>({root:{display:"flex"},searchBar:{position:"relative"},drawer:{[e.breakpoints.up("sm")]:{width:Z,flexShrink:0}},appBar:{[e.breakpoints.up("sm")]:{width:"calc(100% - ".concat(Z,"px)"),marginLeft:Z}},appBar2:{[e.breakpoints.up("sm")]:{width:"calc(100% - ".concat(Z,"px)"),marginLeft:Z}},menuButton:{marginRight:e.spacing(2),[e.breakpoints.up("sm")]:{display:"none"}},toolbar:e.mixins.toolbar,drawerPaper:{width:Z},content:{flexGrow:1,padding:e.spacing(3)},title:{flexGrow:1,padding:"10px",color:"#F5F5DC\t",fontSize:"16px"},search:{float:"right"},signout:{marginLeft:"3px"}}))),ee=(e,t)=>{localStorage.removeItem("token"),t({type:"clear"}),e("/signin")},te=r.a.forwardRef((function(e,t){return Object(Y.jsx)(H.a,{direction:"up",ref:t,...e})}));t.a=Object(c.g)((e=>{const t=document.body,a=$(),[c,s]=r.a.useState(!1),l=Object(o.b)();console.log("props.match.params",e,e.location.pathname);const b=e.location.pathname,[w,S]=Object(n.useState)(!1),[C,I]=Object(n.useState)(!1),[B,U]=Object(n.useState)([]),A=localStorage.getItem("token"),F=Q.a.create({baseURL:V.a,headers:{Authorization:"bearer ".concat(A)}}),H=()=>S(!1),K=()=>I(!1);const Z=((e,t)=>{let a;return function(){let n=this;clearTimeout(a),a=setTimeout((()=>{e.apply(n,arguments)}),t)}})((function(e){e.preventDefault(),F.post("searchPeople",{searchstring:e.target.value}).then((e=>{const t=e.data;t.status?U(t.users):X.a.error("Something went wrong",{autoComplete:1500})}))}),300),ae=Object(o.c)((e=>e.userReducer.email)),ne=Object(o.c)((e=>e.userReducer.name)),re=Object(o.c)((e=>e.userReducer.path));if(!ne||!ae){Q.a.create({baseURL:V.a,headers:{Authorization:"bearer ".concat(A)}}).get("getUser").then((e=>{const t=e.data;l({type:"load_user",payload:t})})).catch((e=>X.a.error(e)))}const ce=[["Feed","/",i.a],["Friends","/friends",z.a],["Chats","/chats",E.a],["Groups","/groups",N.a],["Enter group","/enterroom",R.a],["Create group","/newroom",d.a]],oe=Object(Y.jsxs)("div",{children:[Object(Y.jsx)("center",{children:Object(Y.jsx)(J.a,{src:V.a+"/uploads/".concat(re,"/").concat(A),style:{borderColor:"#00008B",color:"lightgrey",marginTop:"10px",width:"70px",height:"70px"},onClick:()=>I(!0)})}),Object(Y.jsx)("center",{children:Object(Y.jsx)("p",{children:ne})}),Object(Y.jsx)("div",{className:a.toolbar,style:{marginTop:"-60px"}}),Object(Y.jsx)(h.a,{}),Object(Y.jsx)(m.a,{children:ce.map((t=>Object(Y.jsxs)(O.a,{button:!0,onClick:()=>{"Sign out"===t[0]?ee(e.history.push,l):"Search"===t[0]?S(!0):e.history.push(t[1])},children:[Object(Y.jsx)(f.a,{style:{color:"#00008B"},children:Object(n.createElement)(t[2],{})}),Object(Y.jsx)(g.a,{primary:t[0]})]},t[0])))})]});return Object(Y.jsxs)("div",{children:[Object(Y.jsxs)(T.a,{open:C,onClose:K,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(Y.jsx)(G.a,{id:"alert-dialog-title",children:"Change Profile Picture"}),Object(Y.jsx)("label",{for:"file-input",children:Object(Y.jsx)(P.a,{style:{color:"blue",width:"80px",cursor:"pointer"}})}),Object(Y.jsx)("input",{id:"file-input",name:"file",type:"file",style:{display:"none"},onChange:e=>{document.getElementById("preview").setAttribute("src",window.URL.createObjectURL(e.target.files[0]))}}),Object(Y.jsx)("center",{children:Object(Y.jsx)("img",{id:"preview",src:V.a+"/uploads/".concat(re,"/").concat(A),width:"300px",height:"300px",alt:""})}),Object(Y.jsx)(_.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{let e=document.getElementById("file-input").files[0];if(!document.getElementById("file-input").value)return;K(),document.getElementById("file-input").value="",document.getElementById("loader").style.display="block";let t=new FormData;t.append("file",e),t.append("path",e.name),F.post("updateDp",t).then((t=>{const a=t.data;1===a.status?(e&&(e.value=""),document.getElementById("loader").style.display="none",l({type:"load_user",payload:{name:ne,email:ae,path:e.name}}),localStorage.setItem("token",a.token)):X.a.error("Something went wrong",{autoClose:1e3})})).catch((e=>X.a.error("Something went wrong",{autoClose:1e3})))},children:"Upload"})]}),Object(Y.jsxs)(T.a,{fullScreen:!0,open:w,onClose:H,TransitionComponent:te,children:[Object(Y.jsx)(y.a,{className:a.searchBar,children:Object(Y.jsxs)(p.a,{children:[Object(Y.jsx)(v.a,{edge:"start",color:"inherit",onClick:H,"aria-label":"close",children:Object(Y.jsx)(L.a,{})}),Object(Y.jsx)(q.a,{style:{backgroundColor:"white",borderRadius:"10px"},variant:"outlined",margin:"normal",fullWidth:!0,name:"search",label:"Search people",type:"text",onChange:e=>{e.preventDefault(),Z(e)},autoComplete:"current-password",autoFocus:!0})]})}),Object(Y.jsx)(m.a,{children:B.map((t=>Object(Y.jsxs)(O.a,{button:!0,children:[Object(Y.jsx)(x.a,{children:Object(Y.jsx)(J.a,{src:V.a+"/uploads/".concat(t.path,"/").concat(A),style:{borderColor:"#00008B",color:"lightgrey"}})}),Object(Y.jsx)(g.a,{primary:t.name,secondary:t.email,onClick:()=>{e.history.push("/profile/".concat(t.email,"-").concat(t.name)),S(!1)}})]})))})]}),!(b.includes("/chat/")||b.includes("/personal/")||b.includes("/profile/"))&&Object(Y.jsx)(y.a,{className:a.appBar2,children:Object(Y.jsxs)(p.a,{children:[Object(Y.jsx)(W.a,{variant:"h6",className:a.title,children:{"/":"Feed","/friends":"Friends","/chats":"Chats","/groups":"Groups","/enterroom":"Enter group","/newroom":"Create group","/signin":"Sign in","/signup":"Sign up","/uploadpost":"Create post"}[e.location.pathname]}),!!A&&Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(v.a,{edge:"start",color:"inherit",onClick:()=>S(!0),children:Object(Y.jsx)(D.a,{})}),Object(Y.jsx)(v.a,{color:"inherit",onClick:()=>ee(e.history.push,l),children:Object(Y.jsx)(k.a,{})})]})]})}),Object(Y.jsxs)("nav",{className:a.drawer,"aria-label":"mailbox folders",children:[Object(Y.jsx)("center",{children:Object(Y.jsx)(M.a,{id:"loader",style:{marginTop:"100px",display:"none"}})}),Object(Y.jsx)(j.a,{smUp:!0,implementation:"css",children:Object(Y.jsx)(u.a,{container:t,variant:"temporary",anchor:"right",open:c,onClose:()=>{e.match.params.room?e.history.push("/"):s(!c)},classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0},children:oe})}),Object(Y.jsx)(j.a,{xsDown:!0,implementation:"css",children:Object(Y.jsx)(u.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0,children:oe})})]})]})}))}},[[170,2,3]]]);
//# sourceMappingURL=main.ecdafafa.chunk.js.map